<!DOCTYPE html>
<html lang="en">

<head>
    <title>
        我要咨询
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,user-scalable=no,minimal-ui">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="Expires" content="-1">
    <meta http-equiv="Cache-Control" content="no-cache">
    <link rel="stylesheet" href="./hs_css/reset.css" type="text/css">
    <link rel="stylesheet" href="./hs_css/pub.css" type="text/css">
</head>
<style>
    textarea {
        margin-bottom: 0 !important;
        display: block;
        overflow-y: visible;
        overflow-x: visible;
        min-height: 50px !important;
    }

    .main-content {
        /* margin: 0 10px; */
        /* padding: 10px; */
        margin-bottom: 10px;
        background-color: #fff;
    }

    .main-content div,
    p {
        line-height: 24px;
        font-size: 16px;
        display: flex;
        justify-content: flex-start;
        align-items: center;
        flex-wrap: wrap;
    }

    .main-content div .img-box {
        position: relative;
        padding: 4px;
        display: block;
        width: 32.33%;
    }

    .main-content div .img-box .icon-imgch {
        display: block;
        position: absolute;
        right: 0;
        background: #fff;
        display: inline-block;
        width: 22px;
        height: 21px;
        border-radius: 50%;
    }

    .main-content div .img-box .susConImgs {
        display: block;
        width: 100%;
    }
</style>

<body>
    <!-- submit consult  -->
    <div id="consultSubmit" class="text-off">
        <!-- header -->
        <header id="conSubmitHheader">
            <a href="./hsCourt_listJudge.html" class="icon-left-box" id="backUserDet3">
                <span class="icon-left"></span>
            </a>
            <h1>我要咨询</h1>
        </header>
        <!-- consult submit container  -->
        <div id="submitContent">
            <div class="submit-judge-info">
                <div class="judge-left">
                    <span class="pic">
                        <img src="./hs_img/faguan2.png">
                    </span>
                    <div class="judge-text">
                        <p class="judge-name">张某某</p>
                        <p class="judge-des">法学博士</p>
                    </div>
                </div>
            </div>
            <div class="submit-contain">
                <form action="get">
                    <textarea name="msgword" id="msgword" placeholder="请输入要咨询的内容"></textarea>
                    <div class="main-content">
                        <div>
                            <div class="img-box">
                                <img class="icon-imgch" src="./hs_img/img_chahao.png"></img>
                                <img class="susConImgs" src="./hs_img/zixun1.png">
                            </div>
                            <div class="img-box">
                                <img class="icon-imgch" src="./hs_img/img_chahao.png"></img>
                                <img class="susConImgs" src="./hs_img/zixun2.png">
                            </div>
                        </div>
                    </div>

                    <script>
                        /**
                         * 文本框根据输入内容自适应高度
                         * @param                {HTMLElement}        输入框元素
                         * @param                {Number}                设置光标与输入框保持的距离(默认0)
                         * @param                {Number}                设置最大高度(可选)
                         */
                        var autoTextarea = function (elem, extra, maxHeight) {
                            extra = extra || 0;
                            var isFirefox = !!document.getBoxObjectFor || 'mozInnerScreenX' in window,
                                isOpera = !!window.opera && !!window.opera.toString().indexOf('Opera'),
                                addEvent = function (type, callback) {
                                    elem.addEventListener ?
                                        elem.addEventListener(type, callback, false) :
                                        elem.attachEvent('on' + type, callback);
                                },
                                getStyle = elem.currentStyle ? function (name) {
                                    var val = elem.currentStyle[name];
                                    if (name === 'height' && val.search(/px/i) !== 1) {
                                        var rect = elem.getBoundingClientRect();
                                        return rect.bottom - rect.top -
                                            parseFloat(getStyle('paddingTop')) -
                                            parseFloat(getStyle('paddingBottom')) + 'px';
                                    };
                                    return val;
                                } : function (name) {
                                    return getComputedStyle(elem, null)[name];
                                },
                                minHeight = parseFloat(getStyle('height'));
                            elem.style.resize = 'none';
                            var change = function () {
                                var scrollTop, height,
                                    padding = 0,
                                    style = elem.style;
                                if (elem._length === elem.value.length) return;
                                elem._length = elem.value.length;
                                if (!isFirefox && !isOpera) {
                                    padding = parseInt(getStyle('paddingTop')) + parseInt(getStyle(
                                        'paddingBottom'));
                                };
                                scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
                                elem.style.height = minHeight + 'px';
                                if (elem.scrollHeight > minHeight) {
                                    if (maxHeight && elem.scrollHeight > maxHeight) {
                                        height = maxHeight - padding;
                                        style.overflowY = 'auto';
                                    } else {
                                        height = elem.scrollHeight - padding;
                                        style.overflowY = 'hidden';
                                    };
                                    style.height = height + extra + 'px';
                                    scrollTop += parseInt(style.height) - elem.currHeight;
                                    document.body.scrollTop = scrollTop;
                                    document.documentElement.scrollTop = scrollTop;
                                    elem.currHeight = parseInt(style.height);
                                };
                            };
                            addEvent('propertychange', change);
                            addEvent('input', change);
                            addEvent('focus', change);
                            change();
                        };
                        var text = document.getElementById('msgword');
                        autoTextarea(text);

                        var oImg1 = document.getElementsByClassName('img-box');
                        var len = oImg1.length;
                        if (len == 1) {
                            for (var i = 0; i < len; i++) {
                                oImg1[i].style.width = '100%';
                            }
                        } else if (len == 2) {
                            for (var i = 0; i < len; i++) {
                                oImg1[i].style.width = '48%';
                            }
                        } else if (len >= 3) {
                            for (var i = 0; i < len; i++) {
                                oImg1[i].style.width = '32%';
                            }
                        }

                        var imgCloBtns = document.getElementsByClassName('icon-imgch');
                        var imgSuses = document.getElementsByClassName('susConImgs');
                        var len3 = imgCloBtns.length;
                        for (var i = 0; i < len3; i++) {
                            (function (i) {
                                imgCloBtns[i].addEventListener('touchstart', function () {
                                    console.log('点击关闭图片')
                                    oImg1[i].style.display = 'none';
                                    imgCloBtns[i].style.display = 'none';
                                }, false)
                            }(i))
                        }
                        // for (var i = 0; i < len3; i++) {
                        //     (function (i) {
                        //         imgCloBtns[i].addEventListener('touchstart', function () {
                        //             var oImgs = document.getElementsByClassName('img-box');
                        //             var len4 = oImgs.length;
                        //             console.log('img-box'+oImgs)
                        //             if (len4 == 1) {
                        //                 for (var i = 0; i < len; i++) {
                        //                     oImgs[i].style.width = '100%';
                        //                 }
                        //             } else if (len4 == 2) {
                        //                 for (var i = 0; i < len; i++) {
                        //                     oImgs[i].style.width = '48%';
                        //                 }
                        //             } else if (len4 >= 3) {
                        //                 for (var i = 0; i < len; i++) {
                        //                     oImgs[i].style.width = '32%';
                        //                 }
                        //             }
                        //         }, false)
                        //     }(i))
                        // }
                    </script>
                    <div class="submit-btns">
                        <div class="sub-img">
                            <span class="icon-xiangji"></span>
                            上传图片
                        </div>
                        <div class="sub-audio">
                            <span class="icon-huatong"></span>
                            语音咨询
                        </div>
                    </div>
                    <div class="btn-box">
                        <input class="form-btn" type="button" value="提交" id="submitBtn">
                    </div>
                </form>
            </div>
            <script>
                var oBtnImgs = document.getElementsByClassName('sub-img');
                var oBtnPlays = document.getElementsByClassName('sub-audio');

                var oHuatongs = document.getElementsByClassName('icon-huatong');
                var len1 = oBtnImgs.length;
                var len2 = oBtnPlays.length;
                var flagArry1 = [];
                var flagArry2 = [];
                // console.log('有按钮:' + len2)
                // for (var i = 0; i < len1; i++) {
                //     (function (i) {
                //         flagArry1[i] = 0;
                //         oBtnImgs[i].addEventListener('touchstart', function () {
                //             if (flagArry1[i] == 0) {
                //                 this.classList.add('active');
                //                 flagArry1[i] = 1;
                //             } else if (flagArry1[i] == 1) {
                //                 this.classList.remove('active');
                //                 flagArry1[i] = 0;
                //             }
                //         }, false)
                //     }(i))
                // }
                for (var i = 0; i < len2; i++) {
                    (function (i) {
                        flagArry2[i] = 0;
                        oBtnPlays[i].addEventListener('touchstart', function () {
                            if (flagArry2[i] == 0) {
                                this.classList.add('active');
                                // console.log(oHuatongs[i])
                                this.innerHTML = '<span class="icon-huatong bolang"></span> 结束录音';
                                flagArry2[i] = 1;
                                // console.log('添加active');
                            } else if (flagArry2[i] == 1) {
                                // console.log('取消active');
                                this.classList.remove('active');
                                // oHuatongs[i].classList.remove('bolang');
                                this.innerHTML = '<span class="icon-huatong"></span> 开始录音';
                                flagArry2[i] = 0;
                                console.log(oHuatongs[i])
                            }
                        }, false)
                    }(i))
                }
            </script>
            <!-- submit successfully -->
            <div id="submitSus">
                <div class='sus-con'>
                    <div class="img">
                        <img class="img-top" src="./hs_img/wancheng3.png">
                        <img class="img-bottom" src="./hs_img/wancheng1.png">
                    </div>
                </div>
                <div class="sus-text">
                    咨询成功，耐心等待回复吧 ！！
                </div>
                <div class="guanbi">
                    <input type="button" value="好的" id="fanhui1">
                </div>
            </div>
            <!-- submit warning -->
            <div id="submitWarning">
                <p>
                    <img src="./hs_img/wancheng2.jpg" alt=""> 您已经达到当天提交次数上线，明天再试试吧！
                </p>

                <div class="guanbi">
                    <input type="button" value="好的" id="fanhui2">
                </div>
            </div>
        </div>
    </div>
    <script>
        var oSubmitBtn = document.getElementById('submitBtn');
        // console.log(oSubmitBtn)
        var oSubFail = document.getElementById('submitWarning');
        var oSubSus = document.getElementById('submitSus');
        var subSum = 0;

        oSubmitBtn.addEventListener('touchstart', function () {
            if (subSum > 2) {
                // console.log('达到提交上限')
                oSubFail.style.display = 'flex';
                document.getElementById('fanhui2').addEventListener('touchstart', function () {

                    oSubFail.style.display = 'none';
                }, false)
            } else {

                oSubSus.style.display = 'flex';
                subSum++;

                // console.log('当天已经提交：'+ subSum)
                document.getElementById('fanhui1').addEventListener('touchstart', function () {
                    // console.log('关闭提交成功页面')
                    oSubSus.style.display = 'none';
                }, false)
            }
        }, false);
    </script>
</body>


</html>